{% extends 'user/navbar.html' %}

{% block title %}
Complain List
{% endblock %}

{% block section %}
    <br>
    <h3> <i> {{complain.subject}} </i> </h3>
    <p>
        [
			{% if complain.action == 'ACCEPTED' and complain.thread %}
				Threaded
			{% elif complain.action == 'ACCEPTED' %}
				Accepted for solving
			{% elif complain.action == 'REJECTED' %}
				Rejected
			{% endif %}
		]
         <p><i>Complain ID</i> : {{complain.id}}</i></p>
         <p><i>Subject</i> : {{complain.subject}}</i></p>
         <p><i>Category</i> : {{complain.category}}</p>
         <p><i>Sub-category</i> : {{complain.sub_category}}</p>
         <p><i>Brief </i>:{{complain.brief}}</p>
         <p><i>File</i> :
             {% if complain.file %}
                 <a href = "{{ complain.file.url }}"> {{complain.get_filename}}</i></a>
             {% else %}
                 No file attached
             {% endif %}
         </p>
         
         {% if complain.thread %}
			<p><i>Attached to Thread :</i>
				<a href="/thread/{{ complain.thread }}/">{{ complain.thread.title }} ( {{ complain.thread }} ) </a>
			</p>
			<p><i>Threaded by : </i>
				{{ complain.threaded_at }}
			</p>
			<p><i>Threaded at :</i>
				{{ complain.threaded_at }}
			</p>
         {% endif %}
         
         {% if complain.action == 'REJECTED' %}
			<i>Rejected for :</i> {{ complain.action_msg }}
         {% endif %}
         
         <p align = "right">
			{% if complain.last_edit_at %}
				<i>last edited at </i> {{ complain.last_edit_at }}	<br>
			{% endif %}
			<i>Registered at </i>{{complain.reg_datetime}}
		</p>
		
         <hr>
         {% if not complain.thread and complain.actioin == 'ACCEPTED' %}
             {% if select_button %}
                 <a href = "/complain/{{complain.id}}/select/"> Select to Solve </a> | 
             {% else %}
                 {% if complain.solver.user == user %}
                     <a href = '/complain/{{complain.id}}/add-note/'> Add note </a> |
                     <a href = '/complain/{{complain.id}}/deselect/'> Deselect </a> | 
                 {% else %}
                     <p>
                         This complain already selected by other member.<br>
                         Please try to select other complain.
                    </p>
                {% endif %}
             {% endif %}
         {% endif %}
         <a href = "/complain/"> Back to Complain List</a>
<!--
         NOTE SECTION
-->

             <br><br>
             {% for note in notes %}
                 <br>
                 Note : {{ note.note }} <br>
                 {% if note.file %}
                     File : {{ note.file }} <br>
                 {% endif %}
                 Added by : {{ note.solver.user.username }}<br>
                 <div align = "right">
                     Added at {{ note.reg_datetime }}
                 </div>
                 <hr>
             {% endfor %}

    </p>
{% endblock %}
